<Window x:Class="Present.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="Present" Height="640" Width="1024" MinWidth="600" MinHeight="400"
        Closing="Window_Closing">
    <DockPanel>
        <!-- Menu -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_Openâ€¦" Click="OpenFile_Click" InputGestureText="Ctrl+O"/>
                <MenuItem Header="_Save" Click="SaveFile_Click" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Save _Asâ€¦" Click="SaveFileAs_Click" InputGestureText="Ctrl+Shift+S"/>
                <Separator/>
                <MenuItem Header="_Exit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Presentation">
                <MenuItem Header="_Play" Click="Play_Click" InputGestureText="F5"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="Zoom _In" Click="ZoomIn_Click" InputGestureText="Ctrl+="/>
                <MenuItem Header="Zoom _Out" Click="ZoomOut_Click" InputGestureText="Ctrl+-"/>
                <MenuItem Header="_Reset Zoom" Click="ZoomReset_Click" InputGestureText="Ctrl+0"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Remote Control" Click="ShowRemoteInfo_Click"/>
            </MenuItem>
        </Menu>

        <!-- Toolbar -->
        <ToolBar DockPanel.Dock="Top" Background="#F3F3F3">
            <Button Click="Play_Click" ToolTip="Play Presentation (F5)" Padding="8,4">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="â–¶" Margin="0,0,4,0"/>
                    <TextBlock Text="Play"/>
                </StackPanel>
            </Button>
            <Separator/>
            <Button Click="AddSlide_Click" ToolTip="Add Slide" Padding="8,4" Content="+ Add Slide"/>
            <Button Click="RemoveSlide_Click" ToolTip="Remove Selected Slide" Padding="8,4" Content="âœ• Remove"/>
            <Separator/>
            <Button Click="MoveUp_Click" ToolTip="Move Slide Up" Padding="8,4" Content="â†‘"/>
            <Button Click="MoveDown_Click" ToolTip="Move Slide Down" Padding="8,4" Content="â†“"/>
            <Separator/>
            <Button Click="ZoomIn_Click" ToolTip="Zoom In (Ctrl+=)" Padding="8,4" Content="ï¿½ï¿½+"/>
            <Button Click="ZoomOut_Click" ToolTip="Zoom Out (Ctrl+-)" Padding="8,4" Content="ðŸ”âˆ’"/>
            <Button Click="ZoomReset_Click" ToolTip="Reset Zoom (Ctrl+0)" Padding="8,4" Content="âŠ™"/>
            <Separator/>
            <TextBlock x:Name="RemoteInfoText" VerticalAlignment="Center" Foreground="#555"
                       FontSize="11" Margin="4,0"/>
        </ToolBar>

        <!-- Main content area -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260" MinWidth="150" MaxWidth="500"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*" MinWidth="200"/>
            </Grid.ColumnDefinitions>

            <!-- Left sidebar: slide list -->
            <DockPanel Grid.Column="0" Background="#FAFAFA">
                <Border DockPanel.Dock="Top" Background="#E8E8E8" BorderBrush="#D0D0D0"
                        BorderThickness="0,0,0,1" Padding="8,4">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Slides" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        <TextBlock x:Name="SlideCountLabel" Foreground="#666" Margin="6,0,0,0"
                                   VerticalAlignment="Center" FontSize="11"/>
                    </StackPanel>
                </Border>
                <ListBox x:Name="SlideListBox"
                         AllowDrop="True"
                         SelectionChanged="SlideListBox_SelectionChanged"
                         PreviewMouseLeftButtonDown="SlideListBox_PreviewMouseLeftButtonDown"
                         PreviewMouseMove="SlideListBox_PreviewMouseMove"
                         Drop="SlideListBox_Drop"
                         DragOver="SlideListBox_DragOver"
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         BorderThickness="0"
                         Background="Transparent"
                         VirtualizingPanel.IsVirtualizing="False">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="Padding" Value="0"/>
                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <Border x:Name="ItemBorder"
                                                Background="{TemplateBinding Background}"
                                                BorderThickness="0,0,0,1"
                                                BorderBrush="#E8E8E8">
                                            <ContentPresenter Margin="0"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="ItemBorder" Property="Background" Value="#0078D4"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ItemBorder" Property="Background" Value="#E5F3FB"/>
                                            </Trigger>
                                            <MultiTrigger>
                                                <MultiTrigger.Conditions>
                                                    <Condition Property="IsSelected" Value="True"/>
                                                    <Condition Property="IsMouseOver" Value="True"/>
                                                </MultiTrigger.Conditions>
                                                <Setter TargetName="ItemBorder" Property="Background" Value="#0067BE"/>
                                            </MultiTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0" Background="Transparent">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="32"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0"
                                           Text="{Binding Number}"
                                           Foreground="#888"
                                           FontSize="11"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Margin="0,8"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding Url, UpdateSourceTrigger=LostFocus}"
                                         BorderThickness="0"
                                         Background="Transparent"
                                         Padding="4,8,8,8"
                                         FontSize="12"
                                         TextWrapping="NoWrap"
                                         AcceptsReturn="False"
                                         GotFocus="SlideUrlTextBox_GotFocus"
                                         LostFocus="SlideUrlTextBox_LostFocus"
                                         PreviewKeyDown="SlideUrlTextBox_PreviewKeyDown"
                                         ToolTip="{Binding Url}">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="Foreground" Value="#333"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected}" Value="True">
                                                    <Setter Property="Foreground" Value="White"/>
                                                    <Setter Property="CaretBrush" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch"
                          Background="#D0D0D0" Cursor="SizeWE"/>

            <!-- Right: preview pane -->
            <Grid Grid.Column="2" Background="#222">
                <wv2:WebView2 x:Name="PreviewWebView"
                              Visibility="Collapsed"/>
                <Border x:Name="PreviewPlaceholder"
                        Background="#222"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ“‹" FontSize="48" HorizontalAlignment="Center"
                                   Foreground="#555" Margin="0,0,0,12"/>
                        <TextBlock Text="Add slides in the sidebar" Foreground="#666"
                                   FontSize="14" HorizontalAlignment="Center"/>
                        <TextBlock Text="then select one to preview" Foreground="#555"
                                   FontSize="12" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </DockPanel>
</Window>
